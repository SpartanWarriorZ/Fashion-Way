<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fashion-Way | Modern Fashion Shop</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <!-- Locomotive Scroll CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>
  <!-- Locomotive Scroll JS -->
  <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script>
</head>
<body data-scroll-container>
  <header class="hero" data-scroll-section>
    <div class="hero-bg" data-scroll></div>
    <nav class="navbar sticky" data-scroll>
      <div class="logo">
        <span class="logo-row">
          <span class="fashion">FASHION</span><span class="minus">-</span><span class="way">WAY</span>
        </span>
      </div>
      <button class="burger" id="burgerMenu" aria-label="Menü öffnen" style="display:none;">
        &#9776;
      </button>
      <ul class="nav-links">
        <li><a href="#shop" data-scroll-to>Shop</a></li>
        <li><a href="#lookbook" data-scroll-to>Lookbook</a></li>
        <li><a href="#kontakt" data-scroll-to>Kontakt</a></li>
        <li class="cart-container">
          <button class="cart-btn" id="cartBtn" aria-label="Warenkorb öffnen">
            <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
              <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
            </svg>
            <span class="cart-count" id="cartCount">0</span>
          </button>
        </li>
      </ul>
      <nav class="mobile-nav" id="mobileNav">
        <button class="close-btn" id="closeMobileNav" aria-label="Menü schließen">&times;</button>
        <ul>
          <li><a href="#shop" data-scroll-to>Shop</a></li>
          <li><a href="#lookbook" data-scroll-to>Lookbook</a></li>
          <li><a href="#kontakt" data-scroll-to>Kontakt</a></li>
          <li class="mobile-cart">
            <button class="cart-btn mobile" id="mobileCartBtn" aria-label="Warenkorb öffnen">
              <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
              </svg>
              <span class="cart-count" id="mobileCartCount">0</span>
              <span>Warenkorb</span>
            </button>
          </li>
        </ul>
      </nav>
    </nav>
    <div class="hero-content" data-scroll data-scroll-speed="1.5">
      <h1 class="hero-title">
        <span class="fashion">FASHION</span><span class="minus">-</span><span class="way">WAY</span>
      </h1>
      <p class="hero-subtitle">Dein Weg zu exklusiven Styles, Trends und Inspiration.<br>Erlebe Fashion neu gedacht.</p>
      <a href="#shop" class="cta-btn" data-scroll-to><span>Jetzt shoppen</span></a>
    </div>
  </header>

  <main data-scroll-section style="margin-top:2.5rem;">
    <section class="products" id="shop">
      <div class="shop-main">
        <!-- Sidebar/Kategorien werden auf Mobil über dem Shop angezeigt -->
        <aside class="shop-sidebar">
          <nav class="shop-nav">
            <ul class="main-cat-list">
              <li><button class="main-cat-btn active" data-maincat="herren">Herren</button></li>
              <li><button class="main-cat-btn" data-maincat="damen">Damen</button></li>
              <li><button class="main-cat-btn" data-maincat="kinder">Kinder</button></li>
            </ul>
            <ul class="sub-cat-list">
              <li><button class="sub-cat-btn active" data-subcat="alle">Alle</button></li>
              <li><button class="sub-cat-btn" data-subcat="oberteile">Oberteile</button></li>
              <li><button class="sub-cat-btn" data-subcat="hosen">Hosen</button></li>
              <li><button class="sub-cat-btn" data-subcat="schuhe">Schuhe</button></li>
              <li><button class="sub-cat-btn" data-subcat="accessoires">Accessoires</button></li>
            </ul>
          </nav>
        </aside>
        <div class="shop-products">
          <div class="shop-header" style="text-align:left;margin-bottom:0.25rem;padding:0.1rem 0;margin-left:20px;">
            <h2 class="shop-title" style="
              font-family: 'Montserrat', sans-serif;
              font-weight: 900;
              font-size: 2.5rem;
              color: #18181b;
              margin: 0 0 0.5rem 0;
              text-transform: uppercase;
              letter-spacing: 0.05em;
              background: linear-gradient(135deg, #ff3e55 0%, #ff8c3e 100%);
              -webkit-background-clip: text;
              -webkit-text-fill-color: transparent;
              background-clip: text;
              cursor: pointer;
              transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
              display: inline-block;
              transform: scale(1);
            " onmouseover="this.style.transform='scale(1.05)'; this.style.letterSpacing='0.1em'; this.style.background='linear-gradient(135deg, #ff8c3e 0%, #ff3e55 100%)'; this.style.webkitBackgroundClip='text'; this.style.webkitTextFillColor='transparent'; this.style.backgroundClip='text';" onmouseout="this.style.transform='scale(1)'; this.style.letterSpacing='0.05em'; this.style.background='linear-gradient(135deg, #ff3e55 0%, #ff8c3e 100%)'; this.style.webkitBackgroundClip='text'; this.style.webkitTextFillColor='transparent'; this.style.backgroundClip='text';">Shop</h2>
            <div class="shop-subtitle" style="
              font-family: 'Roboto', sans-serif;
              font-size: 1rem;
              color: #6b7280;
              font-weight: 400;
              margin: 0;
              line-height: 1.4;
            ">Entdecke unsere exklusive Kollektion</div>
          </div>
          
          <div class="shop-sort-bar" style="display:flex;justify-content:flex-end;align-items:center;gap:1rem;margin-bottom:2rem;width:100%;padding:0 20px;">
            <label for="sortPrice" style="font-size:1rem;color:#555;font-weight:500;">Sortieren nach:</label>
            <select id="sortPrice" style="padding:0.5rem 1rem;border-radius:0.5rem;border:1px solid #ececec;font-size:1rem;background:white;cursor:pointer;">
              <option value="default">Standard</option>
              <option value="price-asc">Preis: aufsteigend</option>
              <option value="price-desc">Preis: absteigend</option>
            </select>
          </div>
          
          <div class="shop-grid" id="shopGrid">
            <!-- Die Produkte werden jetzt dynamisch per JS eingefügt -->
          </div>
        </div>
      </div>
    </section>

    <section class="lookbook" id="lookbook" data-scroll-section>
      <!-- Inhalt entfernt -->
    </section>

    <section class="contact" id="kontakt" data-scroll-section>
      <!-- Inhalt entfernt -->
    </section>
  </main>

  <!-- Produktdetail Modal -->
  <div class="product-detail-modal" id="productDetailModal">
    <div class="product-detail-modal-overlay" id="productDetailModalOverlay"></div>
    <div class="product-detail-modal-content">
      <button class="product-detail-modal-close" id="productDetailModalClose" aria-label="Modal schließen">
        <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      
      <div class="product-detail-container">
        <!-- Linke Seite: Produktbild -->
        <div class="product-detail-image-section">
          <div class="product-detail-image-container">
            <div class="zoom-indicator" id="productDetailZoomIndicator">Klick zum Zoomen</div>
            <img id="productDetailImage" src="" alt="Produktbild" class="product-detail-image">
          </div>
          
          <!-- Bildergalerie Thumbnails -->
          <div class="product-detail-thumbnails" id="productDetailThumbnails">
            <!-- Thumbnails werden dynamisch eingefügt -->
          </div>
        </div>
        
        <!-- Rechte Seite: Produktinformationen -->
        <div class="product-detail-info-section">
          <div class="product-detail-header">
            <h2 id="productDetailTitle" class="product-detail-title"></h2>
            <div class="product-detail-category" id="productDetailCategory"></div>
            <div class="product-detail-price" id="productDetailPrice"></div>
          </div>
          
          <div class="product-detail-description" id="productDetailDescription">
            <!-- Beschreibung wird dynamisch eingefügt -->
          </div>
          
          <!-- Größenauswahl -->
          <div class="product-detail-sizes" id="productDetailSizes">
            <h3>Größe wählen</h3>
            <div class="size-options" id="sizeOptions">
              <!-- Größen werden dynamisch eingefügt -->
            </div>
          </div>
          
          <!-- Menge -->
          <div class="product-detail-quantity">
            <h3>Menge</h3>
            <div class="quantity-selector">
              <button class="quantity-btn minus" id="productDetailQuantityMinus">-</button>
              <span class="quantity-display" id="productDetailQuantity">1</span>
              <button class="quantity-btn plus" id="productDetailQuantityPlus">+</button>
            </div>
          </div>
          
          <!-- Verfügbarkeit -->
          <div class="product-detail-availability" id="productDetailAvailability">
            <!-- Verfügbarkeitsstatus wird dynamisch eingefügt -->
          </div>
          
          <!-- Aktionen -->
          <div class="product-detail-actions">
            <button class="product-detail-add-to-cart-btn" id="productDetailAddToCartBtn">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
              </svg>
              In den Warenkorb
            </button>
            <button class="product-detail-buy-now-btn" id="productDetailBuyNowBtn">
              Jetzt kaufen
            </button>
          </div>
          
          <!-- Zusätzliche Informationen -->
          <div class="product-detail-additional-info">
            <div class="info-item">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
              <span>Kostenloser Versand ab 50€</span>
            </div>
            <div class="info-item">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
              <span>30 Tage Rückgaberecht</span>
            </div>
            <div class="info-item">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
              <span>Sichere Bezahlung</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Desktop Combined Action Button -->
  <div class="desktop-combined-action-button" id="desktopCombinedActionBtn">
    <button class="desktop-back-to-top-btn" id="desktopBackToTopBtn" aria-label="Nach oben scrollen">
      <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>
      </svg>
    </button>
    <button class="desktop-cart-action-btn" id="desktopCartActionBtn" aria-label="Warenkorb öffnen">
      <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
        <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
      </svg>
      <span class="desktop-cart-count" id="desktopCartActionCount">0</span>
    </button>
  </div>

    <!-- Mobile Combined Action Button -->
  <div class="mobile-combined-action-button" id="mobileCombinedActionBtn">
    <button class="mobile-back-to-top-btn" id="mobileBackToTopBtn" aria-label="Nach oben scrollen">
      <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>
      </svg>
    </button>
    <button class="mobile-cart-action-btn" id="mobileCartActionBtn" aria-label="Warenkorb öffnen">
      <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
        <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
      </svg>
      <span class="mobile-cart-count" id="mobileCartActionCount">0</span>
    </button>
  </div>

  <!-- Lightbox für Produktbilder (mobil und desktop) -->
  <div id="imageLightbox" class="image-lightbox" style="display:none;">
    <button class="image-lightbox-close" id="imageLightboxClose" aria-label="Schließen">
      &times;
    </button>
    <button class="image-lightbox-arrow image-lightbox-prev" id="imageLightboxPrev" aria-label="Vorheriges Bild">
      &#8592;
    </button>
    <img id="imageLightboxImg" src="" alt="Produktbild groß" class="image-lightbox-img">
    <button class="image-lightbox-arrow image-lightbox-next" id="imageLightboxNext" aria-label="Nächstes Bild">
      &#8594;
    </button>
  </div>

  <footer data-scroll-section>
    <div class="footer-content">
      <div class="footer-logo">FASHION<span class="minus">-</span>WAY</div>
      <ul class="footer-links">
        <li><a href="#shop" data-scroll-to>Shop</a></li>
        <li><a href="#lookbook" data-scroll-to>Lookbook</a></li>
        <li><a href="#kontakt" data-scroll-to>Kontakt</a></li>
      </ul>
      <div class="footer-social">
        <a href="#" aria-label="Instagram"><svg width="24" height="24" fill="currentColor"><use href="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/instagram.svg#icon"></use></svg></a>
        <a href="#" aria-label="Facebook"><svg width="24" height="24" fill="currentColor"><use href="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/facebook.svg#icon"></use></svg></a>
        <a href="#" aria-label="TikTok"><svg width="24" height="24" fill="currentColor"><use href="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/tiktok.svg#icon"></use></svg></a>
      </div>
      <p style="margin-top:1.5rem;">&copy; 2025 FASHION-WAY. All rights reserved.</p>
    </div>
  </footer>
  
  <script src="assets/js/main.js"></script>
  <script>
    // ScrollTo-Fix für Locomotive Scroll bei Anker-Links
    document.querySelectorAll('[data-scroll-to]').forEach(link => {
      link.addEventListener('click', function(e) {
        const targetId = this.getAttribute('href');
        if (targetId && targetId.startsWith('#')) {
          e.preventDefault();
          const target = document.querySelector(targetId);
          if (target) {
            scroll.scrollTo(target, { offset: 0, duration: 800, disableLerp: false });
          }
          if (targetId === '#shop' && window.innerWidth <= 900) {
            scroll.scrollTo(target, { offset: -100, duration: 800, disableLerp: false });
          }
        }
      });
    });

    // GSAP Animationen
    gsap.from(".hero-title .highlight", {
      y: 80, opacity: 0, duration: 1.2, ease: "power4.out",
      scrollTrigger: {
        trigger: ".hero-title .highlight",
        scroller: "[data-scroll-container]",
        start: "top 80%"
      }
    });
    gsap.from(".hero-title .redefined", {
      y: 80, opacity: 0, duration: 1.2, delay: 0.2, ease: "power4.out",
      scrollTrigger: {
        trigger: ".hero-title .redefined",
        scroller: "[data-scroll-container]",
        start: "top 80%"
      }
    });
    gsap.from(".hero-subtitle, .cta-btn", {
      y: 40, opacity: 0, duration: 1, delay: 0.5, stagger: 0.2, ease: "power2.out",
      scrollTrigger: {
        trigger: ".hero-subtitle",
        scroller: "[data-scroll-container]",
        start: "top 90%"
      }
    });
    gsap.utils.toArray(".product-card").forEach((card, i) => {
      gsap.from(card, {
        scrollTrigger: {
          trigger: card,
          scroller: "[data-scroll-container]",
          start: "top 80%",
        },
        y: 60,
        opacity: 0,
        duration: 1,
        delay: i * 0.15,
        ease: "power3.out"
      });
    });

    // Produktdaten aus localStorage laden (Simple CMS)
    let products = {};
    
    async function loadProductsFromSimpleCMS() {
      try {
        // Versuche zuerst aus localStorage zu laden
        const savedProducts = localStorage.getItem('fashionWayProducts');
        if (savedProducts) {
          const allProducts = JSON.parse(savedProducts);
          console.log('Produkte aus Simple CMS geladen:', allProducts);
          
          // Daten in das erwartete Format konvertieren
          // Nur Produkte mit Bestand > 0 werden auf der Website angezeigt
          products = {
            herren: allProducts.filter(p => p.category === 'herren' && p.stock > 0).map(p => ({
              name: p.name,
              price: `${p.price.toFixed(2).replace('.', ',')} €`,
              img: p.image,
              subcat: p.subcategory
            })),
            damen: allProducts.filter(p => p.category === 'damen' && p.stock > 0).map(p => ({
              name: p.name,
              price: `${p.price.toFixed(2).replace('.', ',')} €`,
              img: p.image,
              subcat: p.subcategory
            })),
            kinder: allProducts.filter(p => p.category === 'kinder' && p.stock > 0).map(p => ({
              name: p.name,
              price: `${p.price.toFixed(2).replace('.', ',')} €`,
              img: p.image,
              subcat: p.subcategory
            }))
          };
        } else {
          // Fallback zu statischen Daten
          console.log('Keine Produkte im Simple CMS gefunden, lade Fallback-Daten');
          const response = await fetch('products.json');
          products = await response.json();
        }
        
      } catch (error) {
        console.error('Fehler beim Laden der Produkte:', error);
        // Fallback zu statischen Daten
        products = {
          herren: [],
          damen: [],
          kinder: []
        };
      }
    }

    // Anzahl Produkte pro Kategorie
    const PRODUCTS_PER_CATEGORY = 12;

    function animateProductCards() {
      const cards = document.querySelectorAll('.product-card');
      if ('IntersectionObserver' in window) {
        const observer = new IntersectionObserver((entries, obs) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('visible');
              obs.unobserve(entry.target);
            }
          });
        }, { threshold: 0.15 });
        cards.forEach(card => {
          card.classList.remove('visible');
          observer.observe(card);
        });
      } else {
        cards.forEach(card => card.classList.add('visible'));
      }
    }

    let selectedSort = 'default';

    function renderProducts(maincat, subcat, sort = 'default') {
      const grid = document.getElementById('shopGrid');
      grid.innerHTML = '';
      let list = products[maincat] || [];
      while (list.length < PRODUCTS_PER_CATEGORY) {
        list = list.concat(list);
      }
      // 1. Filtern
      let filtered = (subcat === 'alle') ? list : list.filter(p => p.subcat === subcat);
      // 2. Sortieren
      if (sort === 'price-asc') {
        filtered.sort((a, b) => parseFloat(a.price.replace(',','.')) - parseFloat(b.price.replace(',','.')));
      } else if (sort === 'price-desc') {
        filtered.sort((a, b) => parseFloat(b.price.replace(',','.')) - parseFloat(a.price.replace(',','.')));
      }
      // 3. Auf gewünschte Anzahl kürzen
      filtered = filtered.slice(0, PRODUCTS_PER_CATEGORY);
      filtered.forEach(p => {
        const el = document.createElement('div');
        el.className = 'product-card';
        el.setAttribute('data-maincat', maincat);
        el.setAttribute('data-subcat', p.subcat);
        el.innerHTML = `
          <div class="product-images">
            <img src="${p.img}" alt="${p.name}" class="product-main-img">
            <img src="${p.img}" alt="${p.name}" class="product-hover-img">
          </div>
          <div class="product-content">
            <h3>${p.name}</h3>
            <span class="price">${p.price}</span>
            <button class="buy-btn">Details anzeigen</button>
          </div>
        `;
        grid.appendChild(el);
      });
      animateProductCards();
    }

    document.addEventListener('DOMContentLoaded', function () {
      const mainBtns = document.querySelectorAll('.main-cat-btn');
      const subBtns = document.querySelectorAll('.sub-cat-btn');
      let selectedMain = 'herren';
      let selectedSub = 'alle';

      function filterProducts() {
        renderProducts(selectedMain, selectedSub, selectedSort);
        if (window.ScrollTrigger && window.ScrollTrigger.refresh) ScrollTrigger.refresh();
      }

      mainBtns.forEach(btn => {
        btn.addEventListener('click', function () {
          mainBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          selectedMain = btn.getAttribute('data-maincat');
          subBtns.forEach(b => b.classList.remove('active'));
          const alleBtn = document.querySelector('.sub-cat-btn[data-subcat="alle"]');
          if (alleBtn) {
            alleBtn.classList.add('active');
            selectedSub = 'alle';
          }
          filterProducts();
          // Nur auf Desktop automatisch zum Shop scrollen
          if (window.innerWidth > 900) {
            const shopSection = document.getElementById('shop');
            if (shopSection) {
              scroll.scrollTo(shopSection, { offset: 0, duration: 600, disableLerp: false });
            }
          }
        });
      });
      
      subBtns.forEach(btn => {
        btn.addEventListener('click', function () {
          subBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          selectedSub = btn.getAttribute('data-subcat');
          filterProducts();
          // document.body.style.overflow = ''; // Entfernt, um Scroll-Fehler auf Mobil zu beheben
        });
      });

      // Produkte laden und dann Initial-Filter
      loadProductsFromSimpleCMS().then(() => {
        filterProducts();
      });
    });

    // EventListener für Sortierung
    const sortSelect = document.getElementById('sortPrice');
    if (sortSelect) {
      sortSelect.addEventListener('change', function() {
        selectedSort = this.value;
        filterProducts();
      });
    }



    // Hamburger Menü für Mobil
    document.addEventListener('DOMContentLoaded', function () {
      const burger = document.getElementById('burgerMenu');
      const mobileNav = document.getElementById('mobileNav');
      const closeBtn = document.getElementById('closeMobileNav');
      
      function toggleBurgerDisplay() {
        if (window.innerWidth <= 900) {
          burger.style.display = 'flex';
        } else {
          burger.style.display = 'none';
          mobileNav.classList.remove('active');
          burger.classList.remove('active');
          document.body.style.overflow = '';
        }
      }
      
      toggleBurgerDisplay();
      window.addEventListener('resize', toggleBurgerDisplay);

      burger.addEventListener('click', function () {
        mobileNav.classList.add('active');
        burger.classList.add('active');
        document.body.style.overflow = 'hidden';
        setTimeout(() => {
          const firstLink = mobileNav.querySelector('a');
          if (firstLink) firstLink.focus();
        }, 200);
      });
      
      closeBtn.addEventListener('click', function () {
        mobileNav.classList.remove('active');
        burger.classList.remove('active');
        document.body.style.overflow = '';
      });
      
      // Schließe Menü bei Klick auf Link
      mobileNav.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', function () {
          mobileNav.classList.remove('active');
          burger.classList.remove('active');
          document.body.style.overflow = '';
        });
      });
      
      // Schließe Menü bei Klick außerhalb des Menüs
      document.addEventListener('click', function (e) {
        if (
          mobileNav.classList.contains('active') &&
          !mobileNav.contains(e.target) &&
          e.target !== burger
        ) {
          mobileNav.classList.remove('active');
          burger.classList.remove('active');
          document.body.style.overflow = '';
        }
      });
      
      // ESC schließt das Menü
      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' && mobileNav.classList.contains('active')) {
          mobileNav.classList.remove('active');
          burger.classList.remove('active');
          document.body.style.overflow = '';
        }
      });
    });

    // Back to Top Button Funktionalität
    document.addEventListener('DOMContentLoaded', function() {
      const backToTopBtn = document.getElementById('backToTopBtn');
      
      // Button anzeigen/verstecken basierend auf Scroll-Position
      function toggleBackToTop() {
        // Button immer sichtbar auf Desktop
        backToTopBtn.classList.add('visible');
      }
      
      // Button immer sichtbar machen auf Desktop
      backToTopBtn.classList.add('visible');
      
      // Smooth Scroll nach oben
      function scrollToTop() {
        console.log('scrollToTop called');
        
        // Verschiedene Methoden für Locomotive Scroll
        if (typeof scroll !== 'undefined') {
          console.log('Locomotive Scroll available');
          
          // Methode 1: Direkt scrollTo
          if (scroll.scrollTo) {
            console.log('Using scroll.scrollTo');
            scroll.scrollTo(0, { duration: 800, disableLerp: false });
            return;
          }
          
          // Methode 2: Über die Instanz
          if (scroll.instance && scroll.instance.scrollTo) {
            console.log('Using scroll.instance.scrollTo');
            scroll.instance.scrollTo(0, { duration: 800, disableLerp: false });
            return;
          }
          
          // Methode 3: Über die scroll property
          if (scroll.scroll && scroll.scroll.scrollTo) {
            console.log('Using scroll.scroll.scrollTo');
            scroll.scroll.scrollTo(0, { duration: 800, disableLerp: false });
            return;
          }
        }
        
        // Fallback für normales Scrollen
        console.log('Using native scroll');
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      }
      
      // Event Listeners
      backToTopBtn.addEventListener('click', function(event) {
        event.preventDefault();
        event.stopPropagation();
        console.log('Back to Top Button clicked!');
        scrollToTop();
      });
      
      // Scroll-Event für Locomotive Scroll
      if (window.scroll && window.scroll.on) {
        window.scroll.on('scroll', toggleBackToTop);
      } else {
        // Fallback für normales Scrollen
        window.addEventListener('scroll', toggleBackToTop);
      }
      
      // Initial check
      toggleBackToTop();
    });



    // Diese Event-Handler wurden entfernt, da sie unerwünschte Scroll-Events verursachten
    // window.addEventListener('beforeunload', function () {
    //   window.scrollTo(0, 0);
    // });

    // window.addEventListener('DOMContentLoaded', function () {
    //   setTimeout(function() {
    //     if (window.scroll && window.scroll.scrollTo) {
    //       window.scroll.scrollTo(0, { duration: 0, disableLerp: true });
    //     } else {
    //       window.scrollTo(0, 0);
    //     }
    //   }, 10);
    // });
    // window.addEventListener('load', function () {
    //   setTimeout(function() {
    //     if (window.scroll && window.scroll.scrollTo) {
    //       window.scroll.scrollTo(0, { duration: 0, disableLerp: true });
    //     } else {
    //       window.scrollTo(0, 0);
    //     }
    //   }, 10);
    // });

    // Logo-Klick scrollt nach oben (nur auf Mobil)
    document.addEventListener('DOMContentLoaded', function () {
      var logo = document.querySelector('.logo');
      if (logo) {
        logo.style.cursor = 'pointer';
        logo.addEventListener('click', function(e) {
          if (window.innerWidth > 900) return; // Auf Desktop kein Scrollen
          e.preventDefault();
          if (window.scroll && window.scroll.scrollTo) {
            window.scroll.scrollTo(0, { duration: 800, disableLerp: false });
          } else {
            window.scrollTo({ top: 0, behavior: 'smooth' });
          }
        });
      }
    });
  </script>
</body>
</html>
